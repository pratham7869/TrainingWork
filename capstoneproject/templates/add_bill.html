<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add New Bill</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="form">
  <a href="{{ url_for('admin_dashboard') }}" class="logout">Back to Dashboard</a>
  <header>

    <h1 align="center">Add Items</h1>
      </header>
    <form method="POST" action="{{ url_for('add_bill') }}" class="form">
        <table class="center-table">
        <tr>
        <td><label for="bill_number" class="formlabel">Bill Number:</label></td>
        <td><input type="text" id="bill_number" name="bill_number" required></td>
        </tr>
        <tr>
        <td><label for="bill_date">Bill Date:</label></td>
        <td><input type="date" id="bill_date" name="bill_date" required></td>
        </tr>
        <tr>
        <td><label for="bill_amount">Bill Amount:</label></td>
        <td><input type="number" id="bill_amount" name="bill_amount" required></td>
        </tr>
        <tr>
        <td><label for="num_items">Number of rows:</label></td>
        <td><input type="number" id="num_items" name="num_items" max="15" required></td>
        </tr>
        <tr>
        <td colspan="2" class="center-table">
              <button type="button" onclick="generateItemRows()" class="button" >Generate Item Rows</button>
        </td>
        </tr>
        </table>


        <table id="item_rows" class="center-table">
            <!-- Item rows will be dynamically generated here -->
        </table>

         <table id="item_rows2" class="center-table">
            <!-- Item rows will be dynamically generated here -->
        </table>



    </form>

    <script>
        function generateItemRows() {
            const numItems = document.getElementById('num_items').value;
            const itemRows = document.getElementById('item_rows');
            const itemRows2 = document.getElementById('item_rows2');
            itemRows.innerHTML = ''; // Clear any existing rows
            if (numItems > 15) {
                alert("Number of rows cannot exceed 15.");
                return;
            }

            for (let i = 0; i < numItems; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `

                    <td for="item_name_${i}">Item Name:</td>
                    <td><input type="text" id="item_name_${i}" name="item_name_${i}" required></td>

                    <td for="item_type_${i}">Item Type:</td>
                    <td><input type="text" id="item_type_${i}" name="item_type_${i}" required></td>

                    <td for="quantity_${i}">Quantity:</td>
                    <td><input type="number" id="quantity_${i}" name="quantity_${i}" required></td>

                    <td for="warranty_period_${i}">Warranty Period:</td>
                    <td><input type="text" id="warranty_period_${i}" name="warranty_period_${i}" required></td>
                `;
                itemRows.appendChild(row);
            }
            const rows = itemRows2.getElementsByTagName('tr');
            if (rows.length === 0)
            {
            // If no rows exist, create and append the new row
            const row = document.createElement('tr');
            row.innerHTML = `
                <td colspan="8" class="center-table">
                    <input type="submit" value="Submit" class="button">
                </td>
            `;
            itemRows2.appendChild(row);
            }

        }
        function validateForm() {
            const billDateInput = document.getElementById('bill_date');
            const billDate = new Date(billDateInput.value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (billDate > today) {
                alert("Bill date cannot be in the future.");
                return false;
            }
            return true;
        }

        document.getElementById('bill_date').addEventListener('change', function() {
            const billDate = new Date(this.value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (billDate > today) {
                alert("Bill date cannot be in the future.");
                this.value = '';
            }
        });
    </script>
</body>
</html>